<html><head>
   <title>Get IE object from any property</title>
   <meta name="generator"  content="HelpMaker" >
   <meta name="keywords"  content="System Requirements," ></head>
<body bgcolor="FFFCEA" >
<table width="100%"  border="0"  cellspacing="0"  cellpadding="2"  bgcolor="C0C0C0" >
  <tr>
    <td align="left" >
      <html><head><title></title></head><body><div align="left" ><font face="Verdana"  size="7" ><span style=" font-size:12pt" ><b>Getting IE object from any property</b></span></font></div></body></html>

    </td>
    <td align="right" >
      <font face="Arial"  size="2" >
        <a href="getcurrentcursorposition.html">Previous</a>&nbsp;<a href="overview.html">Top</a>&nbsp;<a href="enumrateframesonawebpage.html">Next</a>
      </font>
    </td>
  </tr></table>
<hr><html><head><title></title></head><body><div align="left" ><font face="Courier New"  color="#008000" ><span style=" font-size:10pt" >'SAMPLE QTP script</span></font></div><div align="left" ><font face="Courier New"  color="#008000" ><span style=" font-size:10pt" ><br></span></font></div><div align="left" ><font face="Courier New"  color="#008000" ><span style=" font-size:10pt" >'Create the screen capture object</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Set</span></font><font face="Courier New" ><span style=" font-size:10pt" > oScreenCapture = CreateObject(</span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;KnowledgeInbox.ScreenCapture&quot;</span></font><font face="Courier New" ><span style=" font-size:10pt" >)</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" ><br></span></font></div><div align="left" ><font face="Courier New"  color="#008000" ><span style=" font-size:10pt" >'Launch IE</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" >SystemUtil.Run </span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;iexplore.exe&quot;</span></font><font face="Courier New" ><span style=" font-size:10pt" >, </span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;http://www.google.co.in&quot;</span></font></div><div align="left" ><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" ><br></span></font></div><div align="left" ><font face="Courier New"  color="#008000" ><span style=" font-size:10pt" >'Wait for browser to load</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" >Browser(</span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;creationtime:=0&quot;</span></font><font face="Courier New" ><span style=" font-size:10pt" >).Sync</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" ><br></span></font></div><div align="left" ><font face="Courier New"  color="#008000" ><span style=" font-size:10pt" >'Get the window handle of just opened browser</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" >hwnd = Browser(</span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;creationtime:=0&quot;</span></font><font face="Courier New" ><span style=" font-size:10pt" >).GetROProperty(</span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;hwnd&quot;</span></font><font face="Courier New" ><span style=" font-size:10pt" >)</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" ><br></span></font></div><div align="left" ><font face="Courier New"  color="#008000" ><span style=" font-size:10pt" >'Various ways to get the IE object using different properties</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Set</span></font><font face="Courier New" ><span style=" font-size:10pt" > oIE = oScreenCapture.GetIEObjectFromProperty(</span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;hwnd&quot;</span></font><font face="Courier New" ><span style=" font-size:10pt" >, hwnd)</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Set</span></font><font face="Courier New" ><span style=" font-size:10pt" > oIE = oScreenCapture.GetIEObjectFromProperty(</span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;document&quot;</span></font><font face="Courier New" ><span style=" font-size:10pt" >, 
Browser(</span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;creationtime:=0&quot;</span></font><font face="Courier New" ><span style=" font-size:10pt" >).object.document)</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Set</span></font><font face="Courier New" ><span style=" font-size:10pt" > oIE = oScreenCapture.GetIEObjectFromProperty(</span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;document&quot;</span></font><font face="Courier New" ><span style=" font-size:10pt" >, 
Browser(</span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;creationtime:=0&quot;</span></font><font face="Courier New" ><span style=" font-size:10pt" >).Page(</span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;micclass:=Page&quot;</span></font><font face="Courier New" ><span style=" font-size:10pt" >).object)</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Set</span></font><font face="Courier New" ><span style=" font-size:10pt" > oIE = oScreenCapture.GetIEObjectFromProperty(</span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;document.title&quot;</span></font><font face="Courier New" ><span style=" font-size:10pt" >, </span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;Google&quot;</span></font><font face="Courier New" ><span style=" font-size:10pt" >)</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Set</span></font><font face="Courier New" ><span style=" font-size:10pt" > oIE = oScreenCapture.GetIEObjectFromProperty(</span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;document.location&quot;</span></font><font face="Courier New" ><span style=" font-size:10pt" >, </span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;http://www.google.co.in&quot;</span></font><font face="Courier New" ><span style=" font-size:10pt" >)</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" ><br></span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" ><br></span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >If</span></font><font face="Courier New" ><span style=" font-size:10pt" > </span></font><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Not</span></font><font face="Courier New" ><span style=" font-size:10pt" > oIE </span></font><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Is</span></font><font face="Courier New" ><span style=" font-size:10pt" > </span></font><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Nothing</span></font><font face="Courier New" ><span style=" font-size:10pt" > </span></font><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Then</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oIE.Navigate2 </span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;www.knowledgeinbox.com&quot;</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >End</span></font><font face="Courier New" ><span style=" font-size:10pt" > </span></font><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >If</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" ><br></span></font></div><div align="left" ><font face="Courier New"  color="#008000" ><span style=" font-size:10pt" >'Destroy the object</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Set</span></font><font face="Courier New" ><span style=" font-size:10pt" > oScreenCapture = </span></font><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Nothing</span></font></div><div align="left" >&nbsp;&nbsp;</div></body></html>

</body></html>
