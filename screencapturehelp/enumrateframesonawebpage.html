<html><head>
   <title>Enumerate frames document on a web page</title>
   <meta name="generator"  content="HelpMaker" >
   <meta name="keywords"  content="System Requirements," ></head>
<body bgcolor="FFFCEA" >
<table width="100%"  border="0"  cellspacing="0"  cellpadding="2"  bgcolor="C0C0C0" >
  <tr>
    <td align="left" >
      <html><head><title></title></head><body><div align="left" ><font face="Verdana"  size="7" ><span style=" font-size:12pt" ><b>Enumerate frames document on a web page</b></span></font></div></body></html>

    </td>
    <td align="right" >
      <font face="Arial"  size="2" >
        <a href="captureieobjectfromanyproperty.html">Previous</a>&nbsp;<a href="overview.html">Top</a>&nbsp;<a href="captureiewebpagespecificobject.html">Next</a>
      </font>
    </td>
  </tr></table>
<hr><html><head><title></title></head><body><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Set</span></font><font face="Courier New" ><span style=" font-size:10pt" > FSO = CreateObject(</span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;Scripting.FileSystemObject&quot;</span></font><font face="Courier New" ><span style=" font-size:10pt" >)</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Dim</span></font><font face="Courier New" ><span style=" font-size:10pt" > fileName</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" >fileName = FSO.GetSpecialFolder(2) &amp; </span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;\IFrameTest.html&quot;</span></font></div><div align="left" ><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" ><br></span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Set</span></font><font face="Courier New" ><span style=" font-size:10pt" > oFile = FSO.CreateTextFile(fileName,</span></font><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >True</span></font><font face="Courier New" ><span style=" font-size:10pt" >)</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" >oFile.Write </span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;&lt;HTML&gt;&lt;BODY&gt;&lt;IFRAME name=google 
src=&quot;&quot;http://www.google.co.in&quot;&quot;&gt;&lt;/BODY&gt;&lt;/HTML&gt;&quot;</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" >oFile.Close</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" ><br></span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Set</span></font><font face="Courier New" ><span style=" font-size:10pt" > oIE = CreateObject(</span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;InternetExplorer.Application&quot;</span></font><font face="Courier New" ><span style=" font-size:10pt" >)</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" ><br></span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" >oIE.Navigate2 fileName</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" >oIE.Visible = </span></font><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >True</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" >oIE.FullScreen = </span></font><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >False</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" ><br></span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >While</span></font><font face="Courier New" ><span style=" font-size:10pt" > oIE.Busy</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" ><br></span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Wend</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" ><br></span></font></div><div align="left" ><font face="Courier New"  color="#008000" ><span style=" font-size:10pt" >'Below line would give a Access is Denied error</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Set</span></font><font face="Courier New" ><span style=" font-size:10pt" > oFrameDoc = 
oIE.document.getElementsByTagName(</span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;IFRAME&quot;</span></font><font face="Courier New" ><span style=" font-size:10pt" >).item(0).contentWindow.document</span></font></div><div align="left" ><font face="Arial"  size="7" ><span style=" font-size:12pt" ><br></span></font></div><div align="left" ><font face="Arial"  size="7" ><span style=" font-size:12pt" ><br></span></font></div><div align="left" ><img src="enumrateframesonawebpageb1.PNG"  width="484"  height="262"  border="0"  alt="graphic" ></div><div align="left" ><font face="Verdana"  size="7" ><span style=" font-size:12pt" ><br></span></font></div><div align="left" ><font face="Verdana" ><span style=" font-size:10pt" >Now we can overcome this access denied error using the EnumIEFramesDocument</span></font></div><div align="left" ><font face="Verdana" ><span style=" font-size:10pt" ><br></span></font></div><div align="left" ><font face="Courier New"  color="#008000" ><span style=" font-size:10pt" >'Create the IFRAME test file</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Set</span></font><font face="Courier New" ><span style=" font-size:10pt" > FSO = CreateObject(</span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;Scripting.FileSystemObject&quot;</span></font><font face="Courier New" ><span style=" font-size:10pt" >)</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Dim</span></font><font face="Courier New" ><span style=" font-size:10pt" > fileName</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" >fileName = FSO.GetSpecialFolder(2) &amp; </span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;\IFrameTest.html&quot;</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Set</span></font><font face="Courier New" ><span style=" font-size:10pt" > oFile = FSO.CreateTextFile(fileName,</span></font><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >True</span></font><font face="Courier New" ><span style=" font-size:10pt" >)</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" >oFile.Write </span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;&lt;HTML&gt;&lt;BODY&gt;&lt;IFRAME name=google 
src=&quot;&quot;http://www.google.co.in&quot;&quot;&gt;&lt;/BODY&gt;&lt;/HTML&gt;&quot;</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" >oFile.Close</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" ><br></span></font></div><div align="left" ><font face="Courier New"  color="#008000" ><span style=" font-size:10pt" >'Launch IE</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Set</span></font><font face="Courier New" ><span style=" font-size:10pt" > oIE = CreateObject(</span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;InternetExplorer.Application&quot;</span></font><font face="Courier New" ><span style=" font-size:10pt" >)</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" ><br></span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" >oIE.Navigate2 fileName</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" >oIE.Visible = </span></font><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >True</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" >oIE.FullScreen = </span></font><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >False</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" ><br></span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >While</span></font><font face="Courier New" ><span style=" font-size:10pt" > oIE.Busy</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" ><br></span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Wend</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" ><br></span></font></div><div align="left" ><font face="Courier New"  color="#008000" ><span style=" font-size:10pt" >'Create the screen capture object</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Set</span></font><font face="Courier New" ><span style=" font-size:10pt" > oScreenCapture = CreateObject(</span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;KnowledgeInbox.ScreenCapture&quot;</span></font><font face="Courier New" ><span style=" font-size:10pt" >)</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" ><br></span></font></div><div align="left" ><font face="Courier New"  color="#008000" ><span style=" font-size:10pt" >'Get document object of all frames</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Set</span></font><font face="Courier New" ><span style=" font-size:10pt" > allFrames = oScreenCapture.EnumIEFramesDocument(oIE.Document)</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" ><br></span></font></div><div align="left" ><font face="Courier New"  color="#008000" ><span style=" font-size:10pt" >'Get the google frame</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >For</span></font><font face="Courier New" ><span style=" font-size:10pt" > i = 1 </span></font><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >To</span></font><font face="Courier New" ><span style=" font-size:10pt" > allFrames.count</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" >&nbsp;</span></font><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >If</span></font><font face="Courier New" ><span style=" font-size:10pt" > Instr(allFrames(i).Location,</span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;google&quot;</span></font><font face="Courier New" ><span style=" font-size:10pt" >) </span></font><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Then</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" >&nbsp; </span></font><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Set</span></font><font face="Courier New" ><span style=" font-size:10pt" > oGoogle = allFrames.item(i)</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" >&nbsp; </span></font><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Exit</span></font><font face="Courier New" ><span style=" font-size:10pt" > </span></font><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >For</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" >&nbsp;</span></font><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >End</span></font><font face="Courier New" ><span style=" font-size:10pt" > </span></font><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >If</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Next</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" ><br></span></font></div><div align="left" ><font face="Courier New"  color="#008000" ><span style=" font-size:10pt" >'Access the IFRAME thorugh the document object</span></font></div><div align="left" ><font face="Courier New" ><span style=" font-size:10pt" >oGoogle.getElementsByName(</span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;q&quot;</span></font><font face="Courier New" ><span style=" font-size:10pt" >).item(0).value = </span></font><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" >&quot;This is IFRAME Test&quot;</span></font></div><div align="left" ><font face="Courier New"  color="#a31515" ><span style=" font-size:10pt" ><br></span></font></div><div align="left" ><font face="Courier New"  color="#008000" ><span style=" font-size:10pt" >'Destroy objects</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Set</span></font><font face="Courier New" ><span style=" font-size:10pt" > oScreenCapture = </span></font><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Nothing</span></font></div><div align="left" ><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Set</span></font><font face="Courier New" ><span style=" font-size:10pt" > oIE = </span></font><font face="Courier New"  color="#0000ff" ><span style=" font-size:10pt" >Nothing</span></font></div></body></html>

</body></html>
